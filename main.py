from random import choice as ch

import pygame.image
from simulation import *
from sampling import *


def redrawMap(points, SIZE, thickness, gamedisplay):
    for point in points:
        pygame.draw.circle(gamedisplay, (255, 255, 255), (point[1], point[0]), SIZE, thickness)

# TODO add key
if __name__ == '__main__':
    satellite_image = pygame.image.load("images/Artboard 1.png")

    # Titles the game
    pygame.display.set_caption('Environmental Project')
    clock = pygame.time.Clock()

    WIDTH = 1920
    HEIGHT = 1080

    years = 100
    max_trees = 150

    # TODO move values underneath into actual function call
    pointRadius = 1
    thickness = 5
    innerCircleRadius = 100
    outerCircleRadius = 110
    candidateSamples = 20

    gamedisplay = pygame.display.set_mode((WIDTH, HEIGHT), pygame.FULLSCREEN)
    # 1371
    start = time.time()
    sampling = Sampling(700, 100, 1850, 1000, candidateSamples, innerCircleRadius, outerCircleRadius, thickness,
                        pointRadius)
    points = sampling.getPoints()
    print(f"Time: {time.time() - start}")

    simulation = Simulation(points, years, max_trees)

    end_first_sim = False

    FPS = 20
    gameRunning = True
    a = []
    while gameRunning:
        clock.tick(FPS)
        # Checking events
        events = pygame.event.get()
        for e in events:
            if e.type == pygame.QUIT:
                gameRunning = False
            elif e.type == pygame.MOUSEBUTTONDOWN:
                print(e.pos)
                a.append(e.pos)
                print(a)

        if not end_first_sim:
            end_first_sim = simulation.one_year(gamedisplay)

        # Clearing the display
        gamedisplay.fill((0, 0, 0))
        gamedisplay.blit(satellite_image, satellite_image.get_rect())
        # pygame.draw.polygon(gamedisplay, (0, 0, 0), [(702, 140), (702, 140), (709, 137), (715, 135), (720, 132), (726, 129), (737, 124), (741, 123), (749, 119), (760, 116), (765, 114), (775, 112), (788, 109), (798, 108), (804, 107), (812, 107), (823, 107), (838, 108), (848, 109), (862, 112), (878, 117), (891, 121), (903, 124), (915, 125), (925, 127), (932, 129), (945, 135), (955, 139), (964, 142), (976, 146), (990, 150), (998, 153), (1005, 157), (1013, 160), (1027, 167), (1038, 171), (1045, 174), (1051, 177), (1058, 180), (1066, 184), (1074, 189), (1082, 193), (1095, 199), (1105, 203), (1117, 209), (1129, 214), (1144, 221), (1160, 232), (1175, 243), (1183, 249), (1194, 256), (1206, 264), (1216, 268), (1226, 273), (1234, 276), (1244, 281), (1254, 287), (1267, 293), (1276, 296), (1282, 299), (1287, 301), (1300, 305), (1320, 311), (1336, 316), (1349, 319), (1357, 321), (1372, 323), (1384, 325), (1397, 328), (1408, 331), (1418, 331), (1428, 331), (1441, 328), (1451, 325), (1461, 320), (1469, 316), (1478, 309), (1485, 304), (1493, 297), (1501, 291), (1511, 285), (1517, 279), (1521, 275), (1528, 267), (1539, 257), (1552, 245), (1560, 238), (1567, 230), (1581, 217), (1591, 205), (1606, 190), (1619, 177), (1629, 167), (1639, 159), (1654, 143), (1661, 136), (1672, 124), (1676, 121), (1682, 115), (1696, 104), (1705, 97), (1709, 93), (1711, 92), (1714, 90), (1715, 89), (1715, 89), (1719, 88), (1724, 88), (1736, 91), (1742, 95), (1745, 99), (1748, 105), (1751, 111), (1754, 120), (1759, 131), (1763, 140), (1766, 153), (1771, 166), (1776, 176), (1780, 186), (1783, 199), (1786, 205), (1789, 215), (1791, 221), (1792, 233), (1795, 246), (1798, 255), (1800, 272), (1802, 292), (1804, 303), (1805, 315), (1807, 326), (1809, 339), (1811, 356), (1811, 367), (1813, 380), (1813, 393), (1813, 401), (1810, 413), (1809, 418), (1805, 429), (1800, 450), (1799, 455), (1791, 467), (1776, 492), (1774, 496), (1769, 500), (1755, 514), (1746, 523), (1733, 533), (1712, 547), (1705, 551), (1685, 563), (1659, 581), (1656, 584), (1643, 589), (1625, 597), (1611, 602), (1604, 605), (1598, 608), (1579, 617), (1564, 627), (1553, 631), (1527, 645), (1513, 654), (1503, 659), (1490, 667), (1486, 671), (1470, 683), (1439, 711), (1434, 717), (1431, 720), (1428, 726), (1427, 733), (1424, 741), (1419, 753), (1414, 761), (1406, 772), (1398, 784), (1392, 792), (1387, 805), (1383, 817), (1377, 834), (1368, 852), (1360, 865), (1352, 878), (1349, 886), (1345, 896), (1335, 913), (1328, 923), (1318, 936), (1296, 970), (1290, 976), (1274, 978), (1266, 978), (1274, 971), (1267, 972), (1263, 973), (1259, 972), (1251, 969), (1244, 965), (1233, 957), (1220, 946), (1204, 937), (1188, 928), (1173, 917), (1160, 908), (1147, 899), (1141, 891), (1135, 883), (1128, 873), (1121, 863), (1112, 851), (1100, 838), (1090, 828), (1079, 815), (1070, 804), (1062, 795), (1051, 783), (1043, 772), (1031, 755), (1025, 748), (1019, 738), (1008, 725), (996, 712), (983, 696), (969, 679), (962, 672), (946, 656), (942, 650), (936, 641), (932, 636), (924, 624), (917, 612), (910, 597), (903, 585), (893, 570), (889, 567), (876, 558), (875, 557), (868, 550), (862, 539), (855, 525), (850, 514), (842, 496), (833, 474), (830, 470), (824, 464), (808, 446), (805, 441), (798, 431), (789, 417), (780, 405), (770, 390), (762, 378), (754, 365), (746, 350), (738, 335), (734, 325), (727, 311), (716, 287), (710, 275), (706, 265), (695, 232), (691, 219), (686, 208), (682, 192), (681, 182), (681, 147), (683, 125), (686, 124), (697, 124), (699, 123), (703, 123)])

        # Drawing to the screen
        simulation.get_trees_group().draw(gamedisplay)
        # sampling.draw(None, gamedisplay, (255, 0, 0), True)

        # Updating the display
        pygame.display.update()
